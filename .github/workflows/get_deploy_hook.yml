name: use deploy hook
on: push

jobs:
  test_deploy_hook:
    runs-on: ubuntu-latest
    if: "!contains(github.event.commits[0].message, '[no-ci]')"
    steps:
      - name: set_variable
        id: set_var
        run: |
          # echo "HOOKNAME2=CF_${{ github.ref_name }}_HOOK" >> $GITHUB_ENV
          echo "HOOKNAME=CF_TestNewBranch_HOOK" >> $GITHUB_ENV
      - name: curl_hook
        run: |
          curl -X POST "https://api.cloudflare.com/client/v4/pages/webhooks/deploy_hooks/${{ secrets[steps.set_var.outputs.hookname] }}"
